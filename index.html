<!DOCTYPE html>
<html>
  <head>
    <title>Core Beacon</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
  </head>
  <body>
    <button id="detect">detect</button>
    <button id="scan">scan</button>

    <script>
    var button = document.getElementById('detect');
    button.addEventListener('click', function(event) {
      // Call navigator.bluetooth.requestDevice
      alert('detecting');
    
      alert('referred from ' + navigator.bluetooth.referringDevice);
    });

    var scanButton = document.getElementById('scan');

    scanButton.addEventListener('click', function() {
      let options = {};
      options.acceptAllDevices = true;

      console.log('Requesting Bluetooth Device...');
      console.log('with ' + JSON.stringify(options));
      navigator.bluetooth.requestDevice(options)
      .then(device => {
        console.log('> Name:             ' + device.name);
        console.log('> Id:               ' + device.id);
        console.log('> Connected:        ' + device.gatt.connected);
      })
      .catch(error => {
        console.log('Argh! ' + error);
      });
    });
    </script>
  </body>
</html>
